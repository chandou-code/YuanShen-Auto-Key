# YuanShen 自动按键工具 - 便携版制作指南

## 🚀 三种便携化方案

### 方案1：一键便携版（推荐）
**文件：** `一键便携版.bat`

**特点：**
- 完全自动化，一键创建便携版
- 自动下载Python 3.11.9便携版
- 自动安装所有依赖包
- 最终大小约30MB
- 无需任何预安装

**使用方法：**
1. 双击运行 `一键便携版.bat`
2. 等待下载和安装完成
3. 将生成的 `YuanShenAutoKey` 文件夹复制到任意电脑
4. 双击 `启动监听器.bat` 即可使用

---

### 方案2：便携环境创建器
**文件：** `创建便携环境.bat`

**特点：**
- 更可控的创建过程
- 支持自定义配置
- 分步骤显示进度
- 包含详细的下载说明

---

### 方案3：PyInstaller打包
**文件：** `build_exe.py`

**特点：**
- 打包成单个exe文件
- 启动速度更快
- 更专业的分发包
- 但exe文件较大

**使用方法：**
```bash
# 安装打包工具
pip install pyinstaller

# 运行打包脚本
python build_exe.py
```

---

## 📦 便携版文件结构

```
YuanShenAutoKey/
├── python/                     # 内置Python环境
│   ├── python.exe
│   ├── python311._pth
│   └── Lib/
├── 启动监听器.bat             # 主程序入口
├── 管理员模式.bat              # 手动启动器
├── yuanshen_monitor.py         # 监听脚本
├── __init__.py                 # 自动按键脚本
├── 管理员启动.py              # 管理员启动器
└── 使用说明.txt                # 详细说明
```

## ✨ 便携版特性

- **🌍 完全便携**：无需安装Python或任何依赖
- **🚀 一键启动**：双击即可使用
- **🔧 自动配置**：自动设置环境变量
- **🛡️ 管理员权限**：自动请求必要权限
- **📱 进程监听**：自动检测游戏启动/关闭
- **🎮 智能控制**：游戏内使用鼠标侧键控制

## 🎯 使用流程

1. **创建便携版**：运行任一打包脚本
2. **复制到目标电脑**：整个文件夹复制即可
3. **启动监听器**：双击 `启动监听器.bat`
4. **开始游戏**：启动原神自动开始空格+F
5. **游戏中操作**：鼠标侧键控制按键开关
6. **结束游戏**：关闭原神自动停止脚本

## 📋 系统要求

- Windows 7 或更高版本
- 网络连接（首次创建便携版时）
- 管理员权限（运行时）

## 🔧 故障排除

### 常见问题：

**Q: 下载失败怎么办？**
A: 检查网络连接，或手动下载Python便携版

**Q: 提示UAC权限错误？**
A: 右键以管理员身份运行

**Q: 杀毒软件报毒？**
A: 添加文件夹到白名单

**Q: 无法启动监听器？**
A: 检查是否缺少某些DLL，可安装Visual C++ Redistributable

---

## 📞 技术支持

如遇到问题，请检查：
1. 网络连接是否正常
2. 防火墙/杀毒软件设置
3. 系统管理员权限
4. Windows版本兼容性

**推荐使用方案1（一键便携版），最简单可靠！**